
###################    GBM    Score-81.6%  ########################################

library(readr)
train = read_csv(file = "F:\\Desktop1\\Padhai Likhai\\Kaggle Competition\\Homesite\\train.csv")
test = read_csv(file = "F:\\Desktop1\\Padhai Likhai\\Kaggle Competition\\Homesite\\test.csv")

M <- sapply(train, function(x) sum(is.na(x))) #Making a list M of variables with missing values
M[M>0]  #CHecking variables with NA missing values greater than zero

MT <- sapply(test, function(x) sum(is.na(x)))
MT[MT>0]

str(train$PersonalField84)
str(train$PropertyField29)

#Removing the columns with missing values and date columns
train$PersonalField84 = NULL
train$PropertyField29 = NULL
test$PersonalField84 = NULL
test$PropertyField29 = NULL
train$Original_Quote_Date = NULL
test$Original_Quote_Date = NULL

#Checking out the classes of different variables
sapply(train, function (x) class(x))

#Changing the character variables into factors
train[sapply(train, is.character)] = lapply(train[sapply(train, is.character)], as.factor)
test[sapply(test, is.character)] = lapply(test[sapply(test, is.character)], as.factor)


library(gbm)
boost = gbm(QuoteConversion_Flag ~., data=train, n.trees=1000, shrinkage = 0.01, distribution = "bernoulli", interaction.depth = 4)
summary(boost)

pred.boost1 = predict(boost, newdata = test, n.trees=1000, type="response")

#Converting the probablities into zeroes & ones
Pred.boostR = ifelse(pred.boost >= 0.5, 1,0)

QuoteNumber = test$QuoteNumber
submission = data.frame(QuoteNumber, Pred.boostR)
colnames(submission) = c("QuoteNumber", "QuoteConversion_Flag")

write_csv(submission, "submit_boost.csv")



###################################################
